
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    
    <title>bridgedb.HTTPServer &mdash; BridgeDB Documentation</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    
<link rel="stylesheet" href="_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" href="_static/css/bootswatch-flatly.css" type="text/css" />
<link rel="stylesheet" href="_static/css/font-awesome.min.css">
<!--[if IE 7]>
<link rel="stylesheet" href="_static/css/font-awesome-ie7.min.css">
<![endif]-->
<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
}
</style>
<link rel="stylesheet" href="_static/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="_static/css/bootstrap-responsive.min.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '',
            VERSION:     '0.0.1-247-g58c46c5',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="_static/js/jquery.min.js"></script>
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="_static/js/bootstrap.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    $('.show-sidebar').click(function(e) {
       e.preventDefault();
       if ($(".show-sidebar").html() == "Open Table Of Contents") {
          $('.for-mobile').removeClass('hidden-phone');
          $(".show-sidebar").html("Close Table Of Contents");
       } else {
          $(".show-sidebar").html("Open Table Of Contents");
       }
    });
  });
</script>
    <link rel="top" title="BridgeDB Documentation" href="index.html" />
    <link rel="up" title="bridgedb" href="bridgedb.html" />
    <link rel="next" title="bridgedb.I18n" href="bridgedb.I18n.html" />
    <link rel="prev" title="bridgedb.Filters" href="bridgedb.Filters.html" /> 
  </head>
  <body>
    <div class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="index.html">BridgeDB Documentation</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right">
              
                <li>
                <a href="genindex.html" title="General Index" accesskey="I">index</a>
                </li>
                <li>
                <a href="py-modindex.html" title="Python Module Index" >modules</a>
                </li>
                <li>
                <a href="bridgedb.I18n.html" title="bridgedb.I18n" accesskey="N">next</a>
                </li>
                <li>
                <a href="bridgedb.Filters.html" title="bridgedb.Filters" accesskey="P">previous</a>
                </li>
                <li>
                <a href="bridgedb.html" accesskey="U">bridgedb</a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">


      
      <div class="row-fluid hidden-desktop hidden-tablet">
      
<div class="span3 ">
  <a class="visible-phone btn btn-small show-sidebar" data-toggle="collapse" data-target=".for-mobile">Open Table Of Contents</a>
  <div class="for-mobile sidebar hidden-phone">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="bridgedb.html">bridgedb</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Bridges.html">bridgedb.Bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Bucket.html">bridgedb.Bucket</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.crypto.html">bridgedb.crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Dist.html">bridgedb.Dist</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.EmailServer.html">bridgedb.EmailServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Filters.html">bridgedb.Filters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">bridgedb.HTTPServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.I18n.html">bridgedb.I18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Main.html">bridgedb.Main</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.parse.html">bridgedb.parse</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.persistent.html">bridgedb.persistent</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Raptcha.html">bridgedb.Raptcha</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.runner.html">bridgedb.runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Stability.html">bridgedb.Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Storage.html">bridgedb.Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Tests.html">bridgedb.Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Util.html">bridgedb.Util</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen_bridge_descriptors.html">gen_bridge_descriptors</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="bridgedb.Filters.html"
                        title="previous chapter">bridgedb.Filters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bridgedb.I18n.html"
                        title="next chapter">bridgedb.I18n</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/bridgedb.HTTPServer.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox">
  <h3>Quick search</h3>
  <form class="search form-search" action="search.html" method="get">
      <div class="input-append">
        <input type="text" class="search-query" name="q">
        <input type="submit" class="btn" value="Go" />
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div>
      </div>
      

      <!-- row -->
      <div class="row-fluid">
         
<div class="span3 visible-desktop visible-tablet">
  <div class=" sidebar hidden-phone">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="bridgedb.html">bridgedb</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Bridges.html">bridgedb.Bridges</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Bucket.html">bridgedb.Bucket</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.crypto.html">bridgedb.crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Dist.html">bridgedb.Dist</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.EmailServer.html">bridgedb.EmailServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Filters.html">bridgedb.Filters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">bridgedb.HTTPServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.I18n.html">bridgedb.I18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Main.html">bridgedb.Main</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.parse.html">bridgedb.parse</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.persistent.html">bridgedb.persistent</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Raptcha.html">bridgedb.Raptcha</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.runner.html">bridgedb.runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Stability.html">bridgedb.Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Storage.html">bridgedb.Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Tests.html">bridgedb.Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridgedb.Util.html">bridgedb.Util</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen_bridge_descriptors.html">gen_bridge_descriptors</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="bridgedb.Filters.html"
                        title="previous chapter">bridgedb.Filters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bridgedb.I18n.html"
                        title="next chapter">bridgedb.I18n</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/bridgedb.HTTPServer.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox">
  <h3>Quick search</h3>
  <form class="search form-search" action="search.html" method="get">
      <div class="input-append">
        <input type="text" class="search-query" name="q">
        <input type="submit" class="btn" value="Go" />
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="span9">
          <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <div class="section" id="module-bridgedb.HTTPServer">
<span id="bridgedb-httpserver"></span><h1>bridgedb.HTTPServer<a class="headerlink" href="#module-bridgedb.HTTPServer" title="Permalink to this headline">¶</a></h1>
<p>This module implements the web (http, https) interfaces to the bridge database.</p>
<dl class="class">
<dt id="bridgedb.HTTPServer.CaptchaProtectedResource">
<em class="property">class </em><tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">CaptchaProtectedResource</tt><big>(</big><em>useRecaptcha=False</em>, <em>recaptchaPrivKey=''</em>, <em>recaptchaPubKey=''</em>, <em>useForwardedHeader=False</em>, <em>resource=None</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#CaptchaProtectedResource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.CaptchaProtectedResource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">twisted.web.resource.Resource</span></tt></p>
<dl class="method">
<dt id="bridgedb.HTTPServer.CaptchaProtectedResource.getClientIP">
<tt class="descname">getClientIP</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#CaptchaProtectedResource.getClientIP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.CaptchaProtectedResource.getClientIP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bridgedb.HTTPServer.CaptchaProtectedResource.render_GET">
<tt class="descname">render_GET</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#CaptchaProtectedResource.render_GET"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.CaptchaProtectedResource.render_GET" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bridgedb.HTTPServer.CaptchaProtectedResource.render_POST">
<tt class="descname">render_POST</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#CaptchaProtectedResource.render_POST"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.CaptchaProtectedResource.render_POST" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="bridgedb.HTTPServer.WebResource">
<em class="property">class </em><tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">WebResource</tt><big>(</big><em>distributor</em>, <em>schedule</em>, <em>N=1</em>, <em>useForwardedHeader=False</em>, <em>includeFingerprints=True</em>, <em>domains=None</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#WebResource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.WebResource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">twisted.web.resource.Resource</span></tt></p>
<p>This resource is used by Twisted Web to give a web page with some
bridges in response to a request.</p>
<p>Create a new WebResource.
distributor &#8211; an IPBasedDistributor object
schedule &#8211; an IntervalSchedule object
N &#8211; the number of bridges to hand out per query.</p>
<dl class="attribute">
<dt id="bridgedb.HTTPServer.WebResource.isLeaf">
<tt class="descname">isLeaf</tt><em class="property"> = True</em><a class="headerlink" href="#bridgedb.HTTPServer.WebResource.isLeaf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bridgedb.HTTPServer.WebResource.render">
<tt class="descname">render</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#WebResource.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.WebResource.render" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bridgedb.HTTPServer.WebResource.getBridgeRequestAnswer">
<tt class="descname">getBridgeRequestAnswer</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#WebResource.getBridgeRequestAnswer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.WebResource.getBridgeRequestAnswer" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a response to a bridge request</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="bridgedb.HTTPServer.WebRoot">
<em class="property">class </em><tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">WebRoot</tt><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#WebRoot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.WebRoot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">twisted.web.resource.Resource</span></tt></p>
<p>Initialize.</p>
<dl class="attribute">
<dt id="bridgedb.HTTPServer.WebRoot.isLeaf">
<tt class="descname">isLeaf</tt><em class="property"> = True</em><a class="headerlink" href="#bridgedb.HTTPServer.WebRoot.isLeaf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="bridgedb.HTTPServer.WebRoot.render_GET">
<tt class="descname">render_GET</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#WebRoot.render_GET"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.WebRoot.render_GET" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="bridgedb.HTTPServer.addWebServer">
<tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">addWebServer</tt><big>(</big><em>cfg</em>, <em>dist</em>, <em>sched</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#addWebServer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.addWebServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up a web server.
cfg &#8211; a configuration object from Main.  We use these options:</p>
<blockquote>
<div>HTTPS_N_BRIDGES_PER_ANSWER
HTTP_UNENCRYPTED_PORT
HTTP_UNENCRYPTED_BIND_IP
HTTP_USE_IP_FROM_FORWARDED_HEADER
HTTPS_PORT
HTTPS_BIND_IP
HTTPS_USE_IP_FROM_FORWARDED_HEADER
RECAPTCHA_ENABLED
RECAPTCHA_PUB_KEY
RECAPTCHA_PRIV_KEY</div></blockquote>
<p>dist &#8211; an IPBasedDistributor object.
sched &#8211; an IntervalSchedule object.</p>
</dd></dl>

<dl class="function">
<dt id="bridgedb.HTTPServer.usingRTLLang">
<tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">usingRTLLang</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#usingRTLLang"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.usingRTLLang" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if we should translate the text into a RTL language</p>
<p>Retrieve the headers from the request. Obtain the Accept-Language header
and decide if we need to translate the text. Install the requisite
languages via gettext, if so. Then, manually check which languages we
support. Choose the first language from the header that we support and
return True if it is a RTL language, else return False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>twisted.web.server.Request</strong> (<em>request</em>) &#8211; Incoming request</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns bool:</th><td class="field-body">Language is right-to-left</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bridgedb.HTTPServer.getAssumedChosenLang">
<tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">getAssumedChosenLang</tt><big>(</big><em>langs</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#getAssumedChosenLang"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.getAssumedChosenLang" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first language in <tt class="docutils literal"><span class="pre">langs</span></tt> and we supprt</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>list</strong> (<em>langs</em>) &#8211; All requested languages</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns string:</th><td class="field-body">Chosen language</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="bridgedb.HTTPServer.setLocaleFromRequestHeader">
<tt class="descclassname">bridgedb.HTTPServer.</tt><tt class="descname">setLocaleFromRequestHeader</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/bridgedb/HTTPServer.html#setLocaleFromRequestHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bridgedb.HTTPServer.setLocaleFromRequestHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the languages from the accept-language header and install them.</p>
<p>Parse the languages in the header, and attempt to install the first one in
the list. If that fails, we receive a <tt class="xref py py-class docutils literal"><span class="pre">gettext.NullTranslation</span></tt>
object, if it worked then we have a <tt class="xref py py-class docutils literal"><span class="pre">gettext.GNUTranslation</span></tt>
object. Whichever one we end up with, add the other get the other
languages and add them as fallbacks to the first. Lastly, install this
chain of translations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> (<a class="reference external" href="https://twistedmatrix.com/documents/current/api/twisted.web.server.Request.html">twisted.web.server.Request</a>) &#8211; An incoming request from a client.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">All requested languages.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row-fluid">
<div class="related navbar ">
  <div class="navbar-inner">
    <ul class="nav pull-right">
      
        <li><a href="genindex.html" title="General Index" >index</a></li>
        <li><a href="py-modindex.html" title="Python Module Index" >modules</a></li>
        <li><a href="bridgedb.I18n.html" title="bridgedb.I18n" >next</a></li>
        <li><a href="bridgedb.Filters.html" title="bridgedb.Filters" >previous</a></li>
        <li><a href="index.html">BridgeDB Documentation</a></li>
        <li><a href="bridgedb.html" >bridgedb</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer>
          &copy; Copyright 2013, The Tor Project, Inc.
        Last updated on 01 December 2013.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>